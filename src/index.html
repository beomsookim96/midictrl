<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MidiCtrl - KORG nanoKEY2 Mapper</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/piano.css">
    <link rel="stylesheet" href="styles/controls.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="app-header">
            <h1>ðŸŽ¹ MidiCtrl - KORG nanoKEY2 Mapper</h1>
            <div class="connection-status">
                <div id="backend-status" class="status-indicator">
                    <span class="status-dot"></span>
                    <span class="status-text">Connecting...</span>
                </div>
                <div id="midi-status" class="status-indicator">
                    <span class="status-dot"></span>
                    <span class="status-text">No Device</span>
                </div>
                <div id="profile-status" class="status-indicator">
                    <span class="status-dot profile-dot"></span>
                    <span class="status-text">Profile 1</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Device Connection Panel -->
            <section class="device-panel">
                <h3>MIDI Device Connection</h3>
                <div class="device-controls">
                    <select id="device-select" disabled>
                        <option value="">Select a MIDI device...</option>
                    </select>
                    <button id="refresh-btn" class="btn">Refresh</button>
                    <button id="connect-btn" class="btn btn-primary" disabled>Connect</button>
                    <button id="disconnect-btn" class="btn btn-secondary" disabled>Disconnect</button>
                </div>
            </section>

            <!-- Piano Keyboard with Controls -->
            <section class="piano-section">
                <!-- Control Buttons on the left -->
                <div class="control-section">
                    <div class="control-grid">
                        <button class="control-btn" data-control="oct-down">OCT-</button>
                        <button class="control-btn" data-control="oct-up">OCT+</button>
                        <button class="control-btn" data-control="pitch-down">PITCH-</button>
                        <button class="control-btn" data-control="pitch-up">PITCH+</button>
                        <button class="control-btn" data-control="mod">MOD</button>
                        <button class="control-btn" data-control="sustain">SUSTAIN</button>
                    </div>
                </div>
                
                <!-- Piano Container -->
                <div id="piano-container" class="piano-container">
                    <div id="piano-keyboard" class="piano-keyboard">
                        <!-- Piano keys will be generated by JavaScript -->
                    </div>
                </div>
            </section>

            <!-- Mapping Panel -->
            <section class="mapping-panel">
                <div class="mapping-header">
                    <h3>Key Mappings</h3>
                    <div class="preset-controls">
                        <select id="preset-select">
                            <option value="">Select Preset...</option>
                            <option value="daw_shortcuts">DAW Shortcuts</option>
                            <option value="gaming_controls">Gaming Controls</option>
                            <option value="text_shortcuts">Text Shortcuts</option>
                            <option value="function_keys">Function Keys</option>
                            <option value="chromatic_numbers">Chromatic Numbers</option>
                            <option value="chromatic_letters">Chromatic Letters</option>
                        </select>
                        <button id="load-preset-btn" class="btn">Load</button>
                        <button id="save-preset-btn" class="btn">Save</button>
                        <button id="clear-all-btn" class="btn btn-warning">Clear All</button>
                    </div>
                </div>
                <div id="mapping-list" class="mapping-list">
                    <!-- Mapping items will be populated by JavaScript -->
                </div>
            </section>
        </main>

        <!-- Key Mapping Modal -->
        <div id="mapping-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h4>Key Mapping Configuration</h4>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Note:</label>
                        <span id="modal-note-info" class="note-info"></span>
                    </div>
                    
                    <div class="form-group">
                        <label for="mapping-type">Mapping Type:</label>
                        <select id="mapping-type">
                            <option value="single_key">Single Key</option>
                            <option value="key_combo">Key Combination</option>
                            <option value="text_input">Text Input</option>
                            <option value="command">System Command</option>
                            <option value="application">Launch Application</option>
                            <option value="website">Open Website</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="trigger-mode">Trigger Mode:</label>
                        <select id="trigger-mode">
                            <option value="press">Press</option>
                            <option value="release">Release</option>
                            <option value="toggle">Toggle</option>
                            <option value="hold">Hold</option>
                        </select>
                    </div>

                    <div id="key-input-group" class="form-group">
                        <label for="key-input">Key:</label>
                        <input type="text" id="key-input" placeholder="Click and press a key...">
                    </div>

                    <div id="modifiers-group" class="form-group">
                        <label>Modifiers:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="ctrl-mod"> Ctrl</label>
                            <label><input type="checkbox" id="shift-mod"> Shift</label>
                            <label><input type="checkbox" id="alt-mod"> Alt</label>
                            <label><input type="checkbox" id="meta-mod"> Meta/Win</label>
                        </div>
                    </div>

                    <div id="text-input-group" class="form-group" style="display: none;">
                        <label for="text-input">Text to Type:</label>
                        <textarea id="text-input" placeholder="Enter text to type when key is pressed..."></textarea>
                    </div>

                    <div id="command-input-group" class="form-group" style="display: none;">
                        <label for="command-input">Command:</label>
                        <input type="text" id="command-input" placeholder="Enter system command...">
                    </div>

                    <div id="application-input-group" class="form-group" style="display: none;">
                        <label for="application-input">Application Path:</label>
                        <input type="text" id="application-input" placeholder="e.g., C:\Program Files\App\app.exe or /usr/bin/app">
                        <div class="input-help">
                            <small>Full path to the application executable</small>
                        </div>
                    </div>

                    <div id="website-input-group" class="form-group" style="display: none;">
                        <label for="website-input">Website URL:</label>
                        <input type="text" id="website-input" placeholder="e.g., https://example.com">
                        <div class="input-help">
                            <small>Full URL including http:// or https://</small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="velocity-sensitive"> Velocity Sensitive
                        </label>
                    </div>

                    <div id="velocity-threshold-group" class="form-group" style="display: none;">
                        <label for="velocity-threshold">Velocity Threshold:</label>
                        <input type="range" id="velocity-threshold" min="1" max="127" value="64">
                        <span id="velocity-value">64</span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="save-mapping-btn" class="btn btn-primary">Save Mapping</button>
                    <button id="delete-mapping-btn" class="btn btn-danger">Delete Mapping</button>
                    <button id="cancel-mapping-btn" class="btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/piano.js"></script>
    <script src="js/mapping.js"></script>
    <script src="js/app.js"></script>
</body>
</html>